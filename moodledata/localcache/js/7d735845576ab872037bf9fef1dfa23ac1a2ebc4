YUI().use('yui2-container','yui2-calendar',function(Y){var YAHOO=Y.YUI2;document.body.className+=' yui-skin-sam';YAHOO.util.Event.onDOMReady(function(){var Event=YAHOO.util.Event,Dom=YAHOO.util.Dom,dialog,calendar;var showBtn=Dom.get("show");Event.on(showBtn,"click",function(){function resetHandler(){calendar.cfg.setProperty("pagedate",calendar.today);calendar.render()}
function closeHandler(){dialog.hide()}
if(!dialog){Event.on(document,"click",function(e){var el=Event.getTarget(e);var dialogEl=dialog.element;if(el!=dialogEl&&!Dom.isAncestor(dialogEl,el)&&el!=showBtn&&!Dom.isAncestor(showBtn,el)){dialog.hide()}});dialog=new YAHOO.widget.Dialog("attcalendarcontainer",{visible:!1,context:["show","tl","bl"],buttons:[{text:M.util.get_string('calclose','attendance'),handler:closeHandler}],draggable:!1,close:!1});dialog.setHeader('');dialog.setBody('<div id="cal"></div>');dialog.render(document.body);dialog.showEvent.subscribe(function(){if(YAHOO.env.ua.ie){dialog.fireEvent("changeContent")}})}
if(!calendar){calendar=new YAHOO.widget.Calendar("cal",{iframe:!1,hide_blank_weeks:!0});calendar.cfg.setProperty("start_weekday",M.attendance.cal_start_weekday);calendar.cfg.setProperty("MONTHS_LONG",M.attendance.cal_months);calendar.cfg.setProperty("WEEKDAYS_SHORT",M.attendance.cal_week_days);calendar.select(new Date(M.attendance.cal_cur_date*1000));calendar.render();calendar.selectEvent.subscribe(function(){if(calendar.getSelectedDates().length>0){Dom.get("curdate").value=calendar.getSelectedDates()[0]/1000;Dom.get("currentdate").submit()}
dialog.hide()});calendar.renderEvent.subscribe(function(){dialog.fireEvent("changeContent")})}
var seldate=calendar.getSelectedDates();if(seldate.length>0){calendar.cfg.setProperty("pagedate",seldate[0]);calendar.render()}
dialog.show()})})})